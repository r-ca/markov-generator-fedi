{% extends 'base.html' %}

{% block title %}処理中{% endblock %}

{% block head_extra %}
<style>
:root {
    --main-title-color: #495057;
    --main-icon-color: #007bff;
}
.progress { height: 12px; border-radius: var(--border-radius); background-color: #e9ecef; overflow: hidden; margin-bottom: 1rem; }
.progress-bar { border-radius: var(--border-radius); transition: width 0.3s ease; }
.progress-text { color: #6c757d; font-size: 0.95rem; margin-bottom: 1.5rem; }
@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
.main-icon i { animation: spin 2s linear infinite; vertical-align: middle; }
</style>
{% endblock %}

{% block content %}
<div class="centered-content">
    <div class="main-icon">
        <i class="bi bi-gear-fill"></i>
    </div>
    <div class="main-title">学習中です...</div>
    {% if d['progress'] == 100 %}
    <div class="progress-text">処理を完了しています</div>
    <div class="progress">
        <div class="progress-bar progress-bar-striped progress-bar-animated bg-success" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
    </div>
    {% else %}
    <div class="progress-text">{{ d['progress_str'] }}</div>
    <div class="progress">
        <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: {{ d['progress'] }}%" aria-valuenow="{{ d['progress'] }}" aria-valuemin="0" aria-valuemax="100"></div>
    </div>
    <div class="mt-3">
        <small class="text-muted">このページは自動で更新されます</small>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block script_extra %}
<script type="text/javascript">
window.onload = function () {
    setInterval(function() { location.reload(); }, 3000);
};
</script>
{% endblock %}
